---
title: "Exploring the extent of gender inequality across the world"
author: "Aashna Kanuga, Karan Sindwani, Neha Saraf, Raj Biswas"
date: "12/9/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(extracat)

ed_data_two <- read_csv("enrollment_by_age.csv") 
```
You are encouraged to be as intellectually honest as possible. That means pointing out flaws in your work, detailing obstacles, disagreements, decision points, etc. – the kinds of “behind-the-scene” things that are important but often left out of reports. You may use the first person (“I”/“We”) or specific team members’ names, as relevant.




# Introduction

*Explain why you chose this topic, and the questions you are interested in studying. List team members and a description of how each contributed to the project.*

In past few years, the discussion about gender inequality has been on the rise. Women everywhere are starting to speak up, and demanding equal rights in all aspects of life. People everywhere - men and women, are involved in making this happen, and a lot of people have been saying that slowly but surely, the situation is improving. But is it truly so? The change that we are seeing, is it consistent throughout the world? Has there been actual significant improvement over years in multiple verticals of life? **(More questions?)** These were some of the questions that we were seeking the answers to, and that is why we chose this topic.  


A list of team members working on this project, along with their contributions:  
1. Aashna Kanuga - Exploratory Data Analysis: Development and Education, and the final report.  
2. Karan Sindwani - Exploratory Data Analysis: Government, and the interactive component.  
3. Neha Saraf - Exploratory Data Analysis: Education, and the interactive component.  
4. Raj Biswas - Exploratory Data Analysis: Employment and Government, and the final report.  


# Description of Data

*Describe how the data was collected, how you accessed it, and any other noteworthy features.*

Originally, the data we had selected was form the [source](https://github.com/BuzzFeedNews/2017-12-eeoc-harassment-charges) of a [Buzzfeed Article](https://www.buzzfeednews.com/article/lamvo/eeoc-sexual-harassment-data) about sexual harrasment in the workplace over twenty years. However, after the initial exploration of the data, we found that the data was too small, and a lot of it was overlapping and showing very similar information. We could not generate very useful visualizations from it - that were not already explored in the original article itself - so we decided to look for other datasets. Then we came across a [dataset](http://www.oecd.org/gender/data/) from the Organisation for Economic Co-operation and Development (OECD) about gender inequality accross various verticals. It is acessible from the link provided, and can be downloaded as distinct or combined csv files.
We decided to include the following verticals in our analysis:  
1. Education:  
2. Employment: This vertical looks at how many men and women are in paid work, who works full-time, and how having children and growing older affect women’s work patterns and earnings differently to men’s.  
3. Development: This vertical includes data about the various discriminatory social institutions against women, like violence and harrasment, restricted freedom, bias against women and laws accross various countries.   
4. Governance:   
In our analysis, we discover patterns for all variables within each vertical, highlight the gender inequality, and draw conclusions about the gneder discrimination for multiple countries accross the world.  

# Analysis of Data Quality
*Provide a detailed, well-organized description of data quality, including textual description, graphs, and code.*  

The data itself was not very messy, because it had been use to create some visualization previously. All of the data was in a tidy format, which was very helpful to us. But the few issues that we faced in terms of data quality are:  
1. Missing Values: The education sector had a lot of missing values in the files, which we explored using the *visna* function to observe the missing data patterns.  
Here is an exmaple:
```{r}
visna(ed_data_two)
```  
We observed that all mising data was contained either in the "Flags" column (which is not to be used in our analysis) and in the "Value" column, which is the primary column we will use in you data analysis. So for all the files in the education sector, we pass the data through a function to eliminate all missing values. 
Note: We chose not to fill missing values with some data that we compute, say mean or zero value, because that substitution leads to very misleading visualisations, because substituting some fixed value might not represent the actual proportion of the value for that particular gender in some country.

2. Dependency of "Value" column: In each file of every vertical, our dependent column is "Value". But in most of the files, the major issue we faced was that the column was dependent on too many factors, which made it difficult to visualize it, because after a point you cannot simply create one graph for every dependency. So, to overcome this issue, we found the most significant columns on which Value depends (by simply drawing histograms to look at the distribution), and then we grouped our data on the other columns and obtained an average observation, which we could then facet over the significant columns.  

3. Very descriptive observations: A lot of our columns had observations that had text that was too long, and unnecessary to show to a user, for which we had to recode some of our columns to include shorter descriptions which are easier to understand.  

4. Incomplete data for "Country" and "Time": Although the data did not have too many 'NA's in particular fields, there were entire rows missing which corresponded to data for many tables for different countries for different years. The four verticals that we chose had data for different number of countries over different timelines, and we chose to work with data that was available, this can be seen in a few of the heatmaps where some blocks are missing due to the above mentioned resaon.

5. Overlap of Data between "Employment" and "Government" verticals: The employment and government verticals had a few tables in common such as wage gap, employment and unemployment rates, etc. We ensured that we picked tables that convey different information and provide different insights about gender inequality in the respective verticals.


incomplete data for time
little overlap bw employment and govt

# Main Analysis
*Provide a detailed, well-organized description of your findings, including textual description, graphs, and code. Your focus should be on both the results and the process. Include, as reasonable and relevant, approaches that didn’t work, challenges, the data cleaning process, etc.*

We performed exploratory data anlysis on the four mentioned verticals. As a part of the analysis we plotted many graphs and charts for each of the tables according to the type of the data and the number of dimensions to be analyzed. Certain plots convey a lot of information and interesting insights into the data whereas a few of them do not show any patterns. We have included more visualizations that provide insights and a few examples of visualizations that fail to do so.

The detailed analysis of each of the verticals are as follows -
1. EDUCATION

2. EMPLOYMENT

a) Gender Wage Gap: The gender wage gap is the percentage of difference in wages received by Men and Women, ideally there should not be any gender wage gap. On plotting the heatmap for gender wage gap over years for different countries, we get the following visualization.

```{r, fig.width=8, fig.height=8}
library("tidyverse")
wage_gap <- read.csv("GENDER_EMP_WAGE_GAP.csv")
wage_gap$Time <- as.factor(wage_gap$Time)
ggplot(wage_gap, aes(Time, Country)) + geom_tile(aes(fill=Value), color = "white") + scale_fill_viridis_c(direction = 1) +
  xlab("Year") + ylab("Country") + ggtitle("Wage Gap Percentage") +
  theme(plot.title = element_text(hjust = 0.5))

```

As we can see in the above heatmap, the gender wage gap is the maximum in Japan and Korea which is surprising as Japan is a developed country and South Korea is widely regarded to be an almost developed country. Since the gender wage gap values for these two countries is so high, it masks the patterns that lie within the data of other countries in the heatmap. Hence, we removed the data from these two countries and obtained the following heatmap.

```{r, fig.width=8, fig.height=8}
wage_gap <- wage_gap[(wage_gap$Country != "Korea") & (wage_gap$Country != "Japan") & (wage_gap$Country != "OECD - Average"),]
ggplot(wage_gap, aes(Time, Country)) + geom_tile(aes(fill=Value), color = "white") + scale_fill_viridis_c(direction = 1) +
  xlab("Year") + ylab("Country") + ggtitle("Wage Gap Percentage") +
  theme(plot.title = element_text(hjust = 0.5))
```

The above heatmap has more intricate patterns that can be seen now. For most countries, the gender wage gap has reduced with time as the movement from lighter colors to darker colors can be seen from the left to right. The only country where the gender wage gap has increased over the years is Estonia. It is also surprising to see that many under-developed like Costa Rica, Colombia and Hungary have the least gender wage gap.

b) Women Board Seat Percentage: This is the percentage of women in the boards of large companies in different countries for the years 2010, 2013 and 2016. The following visualization was obtained on plotting the heatmap for women board seat percentage -

```{r}
board_seats <- read.csv("GENDER_EMP_BOARD_SEATS.csv")
board_seats$Time <- as.factor(board_seats$Time)
ggplot(board_seats, aes(Time, Country)) + geom_tile(aes(fill=Value)) + scale_fill_viridis_c(direction = 1) +
  xlab("Year") + ylab("Country") + ggtitle("Women Board Seat Percentage") +
  theme(plot.title = element_text(hjust = 0.5))
```

As we can see above, Norway and Poland have the highest percentage of women in the boards of large companies. Since the women board seat percentage values for these two countries is so high, it masks the patterns that lie within the data of other countries in the heatmap. Hence, we removed the data from these two countries and obtained the following heatmap.

```{r}
board_seats <- board_seats[(board_seats$Country != "Norway") & (board_seats$Country != "Iceland") & (board_seats$Country != "OECD - Average"),]
ggplot(board_seats, aes(Time, Country)) + geom_tile(aes(fill=Value)) + scale_fill_viridis_c(direction = 1) +
  xlab("Year") + ylab("Country") + ggtitle("Women Board Seat Percentage") +
  theme(plot.title = element_text(hjust = 0.5))
```

The above heatmap has more intricate patterns that can be seen now. For most countries, the women board percentage values have increased with time as the movement from darker colors to lighter colors can be seen from the left to right. The countries with the lowest values are Japan and Korea followed by Chile, Brazil and Mexico. There have been significant improvement in women board seats in countries like France, Sweden, Italy and Sweden over the recent years.

c) Time Spent in Paid/ Unpaid Work: This variable indicates the time spent by men and women on paid and unpaid work. We plotted a cleveland dot plot for the time spent and faceted it over total time spent in work, time spent in paid work and time spent in unpaid work.

```{r, fig.height=12, fig.width=10}
paid_unpaid <- read.csv("GENDER_EMP_PAID_UNPAID.csv")
paid_unpaid$Indicator <- factor(paid_unpaid$Indicator, levels = c("Time spent in total work, by sex", "Time spent in paid work, by sex", "Time spent in unpaid work, by sex"))
paid_unpaid$Sex <- factor(paid_unpaid$Sex, levels = c("Women", "Men"))
ggplot(paid_unpaid, aes(reorder(Country, Value), Value, color = Sex)) + geom_point() + coord_flip() +
  facet_wrap(~Indicator, ncol  = 1) +
  xlab("Country") + ylab("Value") + ggtitle("Time Spent in Paid/ Unpaid work (Mins/Day)") +
  theme(plot.title = element_text(hjust = 0.5))
```

As we can see above, the total time spent by women in work is slightly higher than men. But the surprising insight that we captured in this plot is that men spend most of that total time in paid work whereas women have to do a much higher amount of unpaid work. It can be seen that women spend the highest amount of time in unpaid work in Mexico, Portugal and India. It is discriminatory that women have to spend more time in unpaid work over men.

d) Employment/ Unemploymemt Rate: The employment rate is percentage of people who are willing to work and employed. The unemployment rate is the percentage of people who are seeking a job but unemployed. We plotted a heatmap of the employment rate over years, faceted over men and women. Since the employment rate for Turkey was drastically low, it masked the patterns that lie within the data of other countries in the heatmap. Hence, we removed the data from Turkey and obtained the following heatmap.

```{r, fig.height=12, fig.width=10}
employment_unemployment <- read.csv("GENDER_EMP_UNEMP.csv")
employment_unemployment$Time <- as.factor(employment_unemployment$Time)
subset <- employment_unemployment[employment_unemployment$Indicator == "Employment rate, by sex and age group, quarterly data", ]
subset <- subset[subset$Country != "Turkey", ]
subset <- subset[subset$Age.Group == "25-54", ]
subset$Year <- substr(subset$Time, 4,7)
subset <- subset %>% group_by(Country, Sex, Year) %>% summarise(n = mean(Value))
ggplot(subset, aes(Year, Country)) + geom_tile(aes(fill=n), color = "white") + scale_fill_viridis_c(direction = 1) +
  facet_wrap(~Sex, ncol  = 2, scales = "free_x") +
  xlab("Year") + ylab("Country") + ggtitle("Employment Rate") +
  theme(plot.title = element_text(hjust = 0.5))
```

As we can see above, the employment rate of men is much higher compared to women as it can be seen by the difference in the colors of the facets. After Turkey, countries like Mexico, Greece, Colombia and Chile have the least women employment rates. It can also be seen that the employment rates have not changed for most countires over the years and the disparity remains the same which is a cause for concern.

The heatmap for the unemployment rate has been shown below.

```{r, fig.height=12, fig.width=10}
subset <- employment_unemployment[employment_unemployment$Indicator == "Unemployment rate, by sex and age group, quarterly data", ]
subset <- subset[subset$Age.Group == "25-54", ]
subset$Year <- substr(subset$Time, 4,7)
subset <- subset %>% group_by(Country, Sex, Year) %>% summarise(n = mean(Value))
ggplot(subset, aes(Year, Country)) + geom_tile(aes(fill=n), color = "white") + scale_fill_viridis_c(direction = 1) +
  facet_wrap(~Sex, ncol  = 2, scales = "free_x") +
  xlab("Year") + ylab("Country") + ggtitle("Unemployment Rate") +
  theme(plot.title = element_text(hjust = 0.5))
```

The unemployment rates for men and women are almost the same and there is significant pattern that can be observed in the above heatmap.

3. DEVELOPMENT

4. GOVERNANCE



# Executive Summary
*Provide a short nontechnical summary of the most revealing findings of your analysis written for a nontechnical audience. The length should be approximately two pages (if we were using pages…) Take extra care to clean up your graphs, ensuring that best practices for presentation are followed. Note: “Presentation” here refers to the style of graph, that is, graphs that are cleaned up for presentation, as opposed to the rough ones we often use for exploratory data analysis.*

# Interactive Component
*Select one (or more) of your key findings to present in an interactive format. Be selective in the choices that you present to the user; the idea is that in 5-10 minutes, users should have a good sense of the question(s) that you are interested in and the trends you’ve identified in the data. In other words, they should understand the value of the analysis, be it business value, scientific value, general knowledge, etc.Interactive graphs must follow all of the best practices as with static graphs in terms of perception, labeling, accuracy, etc. You may choose the tool (D3, Shiny, or other) The complexity of your tool will be taken into account: we expect more complexity from a higher-level tool like Shiny than a lower-level tool like D3, which requires you to build a lot from scratch.Make sure that the user is clear on what the tool does and how to use it.Publish your graph somewhere on the web and provide a link in your report in the interactive section. The obvious choices are blockbuilder.org to create a block for D3, and shinyapps.io for Shiny apps but other options are fine. You are encouraged to share experiences on Piazza to help classmates with the publishing process.*
*As applicable, all of the following will be considered in the grading process:*
*-Choice of data and plot types to present*
*-Clear relevance to question(s), project in general*
*-Design of interactive component(s)*
*-Clarity of presentation, including instructions*
*-Technical execution (include a description of what you would work on in the future, what you’ve attempted, etc. so we know it’s on your radar)*

# Conclusion
*Discuss limitations and future directions, lessons learned.*
